"0","## means and sd"
"0","## means from pilot data"
"0","# desc_stat_both[1]   ## mean of w_inf"
"0","# desc_stat_both[2]   ## mean of w_prem"
"0","# desc_stat_both[3]   ## mean of s_inf"
"0","# desc_stat_both[4]   ## mean of s_prem"
"0","## artificial means of expected outcome "
"0","# w_prem = 0.90"
"0","# w_inf = 0.55"
"0","# s_prem = 0.90"
"0","# s_inf = 0.75"
"0","## sd - either use per group or total sd for the whole pilot data"
"0","## sd per group"
"0","# desc_stat_both$sd[1]  ## mean of w_inf"
"0","# desc_stat_both$sd[2]  ## mean of w_prem"
"0","# desc_stat_both$sd[3]  ## mean of s_inf"
"0","# desc_stat_both$sd[4]  ## mean of s_prem"
"0","## sd total"
"0","sd_tot ="
"0","        ts_first_all %>%"
"0","        summarise("
"0","                sd_tot = sd(prop)"
"0","        ) %>%"
"0","        pull()"
"0","## creating the tresholds for each group - vary then"
"0","w_prem_th = 0.98"
"0","w_inf_th = 0.55"
"0","s_prem_th = 0.98"
"0","s_inf_th = 0.85"
"0","## double checking means"
"0","mean_w_prem = 0"
"0","mean_w_inf = 0"
"0","mean_s_prem = 0"
"0","mean_s_inf = 0"
"0","## loop paramaters"
"0","nr_sim = 200"
"0","p_value = 0"
"0","set.seed(123)"
"0","## parameters"
"0","nuSubj = 52"
"0","nrCond_bet = 2"
"0","nrCond_wth = 2"
"0","cond_bet = c(""wake"", ""sleep"")"
"0","cond_wth = c(""premise"", ""inference"")"
"0","myData = tibble()"
"0","for(j in 1:nr_sim){"
"0","        "
"0","        ## subject"
"0","        subject = rep(1:nuSubj, times = nrCond_bet)"
"0","        ## create IV within"
"0","        pair = rep(cond_wth, times = nuSubj)"
"0","        ## create IV between"
"0","        cond = rep(cond_bet, each = nrCond_bet, times = nuSubj/nrCond_bet)"
"0","        "
"0","        ## create empty tibble (to reset previous)"
"0","        myData = tibble(condition = cond, pairType = pair)"
"0","        "
"0","        ## arrange to pair type and condition so the dv is added appropriately"
"0","        myData ="
"0","                myData %>%"
"0","                arrange("
"0","                        pairType,"
"0","                        condition"
"0","                )"
"0","        "
"0","        ## creating a sample of each treshold"
"0","        ## random sample with mean and sd from pilot data in range 0 and 1"
"0","        w_inf = rnorm(nuSubj/nrCond_bet, w_inf_th, sd_tot)"
"0","        for(a in 1:length(w_inf)){"
"0","                #print(w_inf[i])"
"0","                if(w_inf[a] >= 1){"
"0","                        w_inf[a] = 1"
"0","                } else if(w_inf[a] <= 0){"
"0","                        w_inf[a] = 0"
"0","                }"
"0","        }"
"0","        "
"0","        "
"0","        w_prem = rnorm(nuSubj/nrCond_bet, w_prem_th, sd_tot)"
"0","        for(b in 1:length(w_prem)){"
"0","                #print(w_inf[i])"
"0","                if(w_prem[b] >= 1){"
"0","                        w_prem[b] = 1"
"0","                } else if(w_inf[b] <= 0){"
"0","                        w_prem[b] = 0"
"0","                }"
"0","        }"
"0","        "
"0","        "
"0","        s_inf = rnorm(nuSubj/nrCond_bet, s_inf_th, sd_tot)"
"0","        for(c in 1:length(s_inf)){"
"0","                #print(w_inf[i])"
"0","                if(s_inf[c] >= 1){"
"0","                        s_inf[c] = 1"
"0","                } else if(w_inf[c] <= 0){"
"0","                        s_inf[c] = 0"
"0","                }"
"0","        }"
"0","        "
"0","        "
"0","        s_prem = rnorm(nuSubj/nrCond_bet, s_prem_th, sd_tot)"
"0","        for(d in 1:length(s_prem)){"
"0","                #print(w_inf[i])"
"0","                if(s_prem[d] >= 1){"
"0","                        s_prem[d] = 1"
"0","                } else if(s_prem[d] <= 0){"
"0","                        s_prem[d] = 0"
"0","                }"
"0","        }"
"0","        "
"0","        ## performance bind - the order is dependent on the arrangment before"
"0","        perf = c(s_inf, w_inf, s_prem, w_prem)"
"0","        "
"0","        ## add performance"
"0","        myData <- "
"0","                myData %>%"
"0","                add_column("
"0","                        perf = perf, .after = ""pairType"""
"0","                ) "
"0","        "
"0","        # convert to factor"
"0","        myData <- "
"0","                myData %>%"
"0","                add_column("
"0","                        subject = subject, .before = ""condition"""
"0","                ) %>%"
"0","                mutate("
"0","                        subject = as.factor(subject),"
"0","                        pairType = as.factor(pairType),"
"0","                        condition = as.factor(condition)"
"0","                        )"
"0","        "
"0","        model <- aov_ez("
"0","                ""subject"","
"0","                ""perf"","
"0","                data = myData,"
"0","                between = c(""condition""),"
"0","                within = c(""pairType"")"
"0","        )"
"0","        "
"0","        p_value[j] = model$anova_table[3, ""Pr(>F)""]"
"0","        mean_w_prem[j] = mean(w_prem)"
"0","        mean_w_inf[j] = mean(w_inf)"
"0","        mean_s_prem[j] = mean(s_prem)"
"0","        mean_s_inf[j] = mean(s_inf)"
"0","                "
"0","}"
"0","## proportion of getting p values from the anova"
"0","propP = sum(p_value<0.05)/nr_sim"
"0","## which means where considered in the model - double check"
"0","meanW_prem = mean(mean_w_prem)"
"0","meanW_inf = mean(mean_w_inf)"
"0","meanS_prem = mean(mean_s_prem)"
"0","meanS_inf = mean(mean_s_inf)"
"0","## results"
"0","# highEffs_40Subj = rbind(propP, meanW_prem, meanW_inf, meanS_prem, meanS_inf)"
"0","highEffs_40Subj"
"1","          "
"1","      [,1]"
"1","
propP     "
"1"," 0.7750000"
"1","
meanW_prem"
"1"," 0.8815592"
"1","
meanW_inf "
"1"," 0.5478451"
"1","
meanS_prem"
"1"," 0.8844100"
"1","
meanS_inf "
"1"," 0.7968919"
"1","
"
"0","highEffs_52Subj = rbind(propP, meanW_prem, meanW_inf, meanS_prem, meanS_inf)"
"0","highEffs_52Subj"
"1","          "
"1","      [,1]"
"1","
propP     "
"1"," 0.8950000"
"1","
meanW_prem"
"1"," 0.8805888"
"1","
meanW_inf "
"1"," 0.5449612"
"1","
meanS_prem"
"1"," 0.8804092"
"1","
meanS_inf "
"1"," 0.8013153"
"1","
"
"0","# lowEffs_40Subj = rbind(propP, meanW_prem, meanW_inf, meanS_prem, meanS_inf)"
"0","lowEffs_40Subj"
"1","          "
"1","      [,1]"
"1","
propP     "
"1"," 0.6250000"
"1","
meanW_prem"
"1"," 0.8645209"
"1","
meanW_inf "
"1"," 0.5478451"
"1","
meanS_prem"
"1"," 0.8677050"
"1","
meanS_inf "
"1"," 0.7595862"
"1","
"
